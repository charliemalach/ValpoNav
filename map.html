<!DOCTYPE html>
<html>

<head>
    <title>ValpoNav - Valparaiso University Campus Map</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" integrity="sha384-HzLeBuhoNPvSl5KYnjx0BT+WB0QEEqLprO+NBkkk5gbc67FTaL7XIGa2w1L0Xbgc" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
    <link rel="stylesheet" href="map.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" sizes="32x32" href="image/favicon.ico">
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.js" charset="utf-8"></script>
    <script src="mapController.js"></script>
</head>

<body style="background-color:  #e3dac8">

    <section>
        <div class="banner">
            <h1 style="font-size: 300%">ValpoNav</h1>
            <h3>Valparaiso University Campus Navigation</h3>

            <!-- Center the search bar -->
            <form id="search-form">
                <input type="text" id="search-input" placeholder="Search building..." style="width: 250px">
                <button type="submit" id="search-button">Search</button>
            </form>

        </div>
    </section>

    <br>
    <!-- JS for the map -->
    <section>
        <div id="map">
            <script src="map.js"></script>
        </div>
    </section>
    <br>

    <!-- Positioning the Form -->
    <section>
        <div class="form-pos">
            <!-- Campus Buildings Checkboxes -->
            <div id="form">
                <h3 style="text-align: center">Campus Buildings</h3>
                <form>
                    <div>
                        <input type="checkbox" id="selectAll" value="selectAll"> Select / Deselect All<br/><br/>
                    </div>
                    
                    <div>
                        <label for="Christopher Center">
                            <a href="#!" onclick="showBuildingMarker('Christopher Center')">Christopher Center</a>
                        </label>
                        <input type="checkbox" id="Christopher Center" value="Christopher Center" checked>
                    </div>
                    <div>
                        <label for="Harre Union">
                            <a href="#!" onclick="showBuildingMarker('Harre Union')">Harre Union</a>
                        </label>
                        <input type="checkbox" id="Harre Union" value="Harre Union" checked>
                    </div>
                    <div>
                        <label for="Neils Science Center">
                            <a href="#!" onclick="showBuildingMarker('Neils Science Center')">Neils Science Center</a>
                        </label>
                        <input type="checkbox" id="Neils Science Center" value="Neils Science Center" checked>
                    </div>
                    <div>
                        <label for="Weseman Hall">
                            <a href="#!" onclick="showBuildingMarker('Weseman Hall')">Weseman Hall</a>
                        </label>
                        <input type="checkbox" id="Weseman Hall" value="Weseman Hall" checked>
                    </div>
                </form>
            </div>

            <!-- Off Campus / OneCard Checkboxes -->
            <div id="form">
                <h3 style="text-align: center">Off-Campus Buildings</h3>
                <form>
                    <div>
                        <input type="checkbox" id="selectAll" value="selectAll"> Select / Deselect All<br/><br/>
                    </div>
                    <div>
                        <label for="Dominos Pizza">
                        <a href="#!" onclick="showBuildingMarker('Dominos Pizza')">Dominos Pizza</a>
                    </label>
                        <input type="checkbox" id="Dominos Pizza" value="Dominos Pizza" checked>
                    </div>
                    <div>
                        <label for="Panera Bread">
                        <a href="#!" onclick="showBuildingMarker('Panera Bread')">Panera Bread</a>
                    </label>
                        <input type="checkbox" id="Panera Bread" value="Panera Bread" checked>
                    </div>
                    <div>
                        <label for="Hungry Howies">
                        <a href="#!" onclick="showBuildingMarker('Hungry Howies')">Hungry Howie's</a>
                    </label>
                        <input type="checkbox" id="Hungry Howies" value="Hungry Howies" checked>
                    </div>
                    <div>
                        <label for="Jimmy Johns">
                        <a href="#!" onclick="showBuildingMarker('Jimmy Johns')">Jimmy John's</a>
                    </label>
                        <input type="checkbox" id="Jimmy Johns" value="Jimmy Johns" checked>
                    </div>
                    <div>
                        <label for="CVS Pharmacy">
                        <a href="#!" onclick="showBuildingMarker('CVS Pharmacy')">CVS Pharmacy</a>
                    </label>
                        <input type="checkbox" id="CVS Pharmacy" value="CVS Pharmacy" checked>
                    </div>

            </div>

        </div>
    </section>


    <div>
        <!-- this needs to be moved -->
        <script>
            var checkboxes = document.querySelectorAll("input[type=checkbox]");

            // Listen for changes on the checkboxes
            checkboxes.forEach(function(checkbox) {
                checkbox.addEventListener("change", function() {
                    // Retrieve the selected buildings
                    var selectedBuildings = Array.from(checkboxes).filter(checkbox => checkbox.checked).map(checkbox => checkbox.value);

                    // Clear all markers from the map
                    map.eachLayer(function(layer) {
                        if (layer instanceof L.Marker) {
                            map.removeLayer(layer);
                        }
                    });

                    // Loop through the buildings array and add a marker for each selected building
                    buildings.forEach(function(building) {
                        if (selectedBuildings.includes(building.name)) {
                            var marker = L.marker([building.lat, building.lng]).addTo(map);
                            var popupContent = "<h4 class='building-name'>" + building.name + "</h4>" + "<a href='" + building.link + "' class='building-link' target='_blank'>View Inside</a>";
                            marker.bindPopup(popupContent);
                        }
                    });
                });
            });
        </script>
    </div>

</body>

</html>